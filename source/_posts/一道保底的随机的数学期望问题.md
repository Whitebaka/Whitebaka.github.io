---
title: 一道保底的随机的数学期望问题
date: 2024-01-08 13:46:12
tags:
cover:
---
## 问题
保底抽奖，每次抽奖有0.5的概率抽到2倍，0.4的概率抽到3倍，0.1的概率抽到5倍；假设用户连续10次没有抽到5倍，那么第11次必然会中到5倍。问题是：第X次抽奖，用户可获得的倍数的期望是多少？
## 解答
先泛化一下问题，每次实验有实验结果$A=\{a_0,a_1,a_2,a_3…a_n\}$，每种结果的概率为$B=\{b_0,b_1,b_2,b_3…b_n\}(\sum_{i=0}^nbi=1)$,其中，假设用户连续$x_1$次没有抽到$a_0$,则下一次一定为$a_0$,求第X次抽奖的期望$E$。  
先考虑没有保底的情况，进行$N_1$次实验，会有实验序列$\sigma_1$:
$$ \sigma_1=\{a_0a_1a_2a_ia_0…\},共N_1项$$
根据期望定义和公式，我们可以得出该情况下的期望$E_1$:
$$ E_1=\frac{\sum\sigma_1}{N_1}=\sum_{i=0}^na_ib_i$$
接下来我们考虑有保底的情况，进行$N_2$次实验，会有实验序列$\sigma_2$：
$$ \sigma_2=\{a_0a_1a_2a_ia_0…\},共N_2项$$
对比$\sigma_1$和$\sigma_2$我们会发现，其中的区别是，$\sigma_2$中不可能出现长度为$x_1+1$的字串，其中没有$a_0$出现，而这在$\sigma_1$中是可能出现的。  
如果我们在$\sigma_1$中添加$m$个$a_0$,则会形成序列$\sigma_3$：
$$ \sigma_3=\{a_0a_1a_2a_ia_0…\},共N_1+m项$$
此时$\sigma_3$与$\sigma_2$都是原问题实验的一种可能，在$N_1、N_2$足够大时：
$$ E=E_{\sigma_2}=E_{\sigma_3}=\frac{\sum\sigma_1+ma_0}{N_1+m}=\frac{N_1\sum_{i=0}^na_ib_i+ma_0}{N_1+m} \tag{1}$$
此时我们求出$m$与$N_1$的关系，即可求出$E$。  
我们来思考什么时候需要插入$a_0$：  
①显然，插入$a_0$之前的$x_1$个符号必须是非$a_0$的。  
②此外，如果某位置前$x_1+t(0< t < x_1 )$个符号都是非$a_0$的，那么他也不该插入。因为在它之前应该已经先插入了一个$a_0$。换句话说，插入$a_0$的位置前$x_1+1$个位置，一定是$a_0$。  
③如果序列里有超过$kx_1(k \geq 1)$个非$a_0$,我们需要插入$k$个$a_0$，根据②，插入的位置应该满足前$k_ix_1(k_i\geq1)$个符号都是非$a_0$,且$k_ix_1+1$是$a_0$。
从而我们可以得到在序列$\sigma_2$里找到需要插入$a_0$的位置的概率：
$${P(A)=\sum^{\infty}_{k=1}p_0{p_1^{x_1}}^k=p_0\sum^{\infty}_{k=1}{p_1^{x_1}}^k=p_0\lim_{k\rightarrow {\infty}}\frac{p_1^{x_1}(1-{p_1^{x_1}}^k)}{1-{p_1^{x_1}}}=\frac{p_0p_1^{x_1}}{1-{p_1^{x_1}}}} $$
其中$p_0=b_0,p_1=1-b_0$  
从而可以求出$m$:
$$ m=N_1P(A)=\frac{N_1p_0{p_1^{x_1}}}{1-{p_1^{x_1}}}$$
代入式（1）：
$$\begin{aligned}E=E_{\sigma_2}=E_{\sigma_3} =& \frac{N_1\sum_{i=0}^na_ib_i+ma_0}{N_1+m} \\=& \frac{N_1\sum_{i=0}^na_ib_i+\frac{N_1a_0p_0{p_1^{x_1}}}{1-{p_1^{x_1}}}}{N_1+\frac{N_1p_0{p_1^{x_1}}}{1-{p_1^{x_1}}}}\\=& \frac{\sum_{i=0}^na_ib_i+\frac{a_0p_0{p_1^{x_1}}}{1-{p_1^{x_1}}}}{1+\frac{p_0{p_1^{x_1}}}{1-{p_1^{x_1}}}}\end{aligned}$$
从而我们解决了该问题，针对原问题，有：
$$ A=\{5,2,3\},B=\{0.1,0.5,0.4\},x_1=10 $$
$$ E=\frac{\sum_{i=0}^na_ib_i+\frac{a_0p_0{p_1^{x_1}}}{1-{p_1^{x_1}}}}{1+\frac{p_0{p_1^{x_1}}}{1-{p_1^{x_1}}}}=\frac{2.7+0.053534*5}{1+0.053534}=2.816872$$
由此，问题解决。